import{r as n,U as E,d as O,N as T,u as F,j as e,a as B,b as h}from"./index-dbb2527e.js";import{c as _}from"./index.esm-0691a448.js";import{c as M}from"./index.esm-d3697b5c.js";import{b as G}from"./Header-15d56c07.js";import{c as U,d as W}from"./index.esm-c62830c2.js";import{O as D}from"./Blocks-0e59252c.js";const V=()=>{var C,v;const[r,a]=n.useState(!1),[g,x]=n.useState(null),{userData:i,setUserData:$}=n.useContext(E),[d,H]=n.useState(O()),{checkUserAlreadyLogin:j,notification:y}=n.useContext(T),[L,u]=n.useState(!1);let m=0;const l=n.useRef(null),p=F(),[k,I]=n.useState([]),P=async()=>{await h.get("/api/fetchProduct").then(t=>{I(t.data.data)}).catch(t=>{console.log("Error")})};n.useEffect(()=>{P()},[]),n.useEffect(()=>{const t=s=>{l.current&&!l.current.contains(s.target)&&a(!1)};return document.addEventListener("click",t,!0),()=>{document.removeEventListener("click",t,!0)}},[r]);const N=async t=>{await h.post("/api/removeFromBag",{productID:t}).then(s=>{j()})},b=async t=>{var s;((s=i==null?void 0:i.Bag)==null?void 0:s.length)>0&&(u(!0),await h.post("/api/orderNow").then(o=>{o.data==="Product Ordered"&&(y(o.data),j()),u(!1)}))};return n.useEffect(()=>{var t;Object.keys(d).length>0?(t=i==null?void 0:i.Bag)==null||t.filter(s=>s.Category===d.categoryID||s._id===d.categoryID):i==null||i.Bag},[d]),e.jsx(e.Fragment,{children:r?e.jsx("div",{id:"BagSliderContainer",children:e.jsxs("div",{id:"BagSlider",ref:l,children:[e.jsxs("div",{id:"bag-back-btn",children:[e.jsx(G,{onClick:()=>a(!r)}),e.jsx("h3",{children:"BAG"})]}),!i&&e.jsxs("div",{id:"RegiLogin",children:[e.jsx("p",{children:"100 Reward Points on new registration"}),e.jsx("button",{id:"Login-Register-BTN",onClick:()=>p("/auth/login"),children:"LOGIN/ REGISTER"})]}),i?e.jsx("div",{id:"bagScroll",children:((C=i==null?void 0:i.Bag)==null?void 0:C.length)>0?e.jsx(e.Fragment,{children:(v=i==null?void 0:i.Bag)==null?void 0:v.map((t,s)=>{const o=k.find(A=>A._id===t.productID),f=(o.Price-50)*t.SmallCount,S=o.Price*t.MediumCount,w=(o.Price+50)*t.LargeCount,c=f+S+w;m+=c;let R=`/products/${o.Category}/${o._id}`;return e.jsxs("div",{id:"productCart",onClick:()=>p(R),children:[e.jsxs("div",{id:"productCartFront",children:[e.jsx("img",{src:o.Product_Photo,alt:"CardImage"}),e.jsxs("div",{id:"productDetail",children:[e.jsxs("div",{id:"productName",children:[e.jsx("h3",{children:o.Product_Name}),e.jsxs("h4",{children:["Quantity: ",t.SmallCount>0&&t.SmallCount+"S,"," ",t.MediumCount>0&&t.MediumCount+"M,"," ",t.LargeCount>0&&t.LargeCount+"L,"," "]})]}),e.jsxs("h4",{children:["₹",c]}),e.jsxs("div",{id:"Icons",children:[e.jsx(M,{onClick:()=>N(t.productID)}),g===s?e.jsx(U,{onClick:()=>x(null)}):e.jsx(W,{onClick:()=>x(s)})]})]})]}),e.jsxs("div",{id:"Amount_Info_Show",style:g===s?{height:"100%"}:{height:"0"},children:[e.jsxs("div",{id:"Amount_INFO",children:[e.jsx("h4",{children:"TOTAL :"}),e.jsxs("div",{children:[e.jsxs("p",{children:["Regular ",t.SmallCount&&"*"+t.SmallCount]}),e.jsxs("p",{children:["Medium ",t.MediumCount&&"*"+t.MediumCount]}),e.jsxs("p",{children:["Large ",t.LargeCount&&"*"+t.LargeCount]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:["₹",f]}),e.jsxs("p",{children:["₹",S]}),e.jsxs("p",{children:["₹",w]})]})]}),e.jsxs("div",{id:"TotalAmt",children:[e.jsx("p",{children:"You Pay :"}),e.jsxs("p",{children:["₹",c]})]})]})]},s)})}):e.jsx("div",{id:"productCart",style:{textAlign:"center"},children:"No Item Found in Bag"})}):e.jsxs("div",{id:"bagScroll",className:"userNotLogin",children:[e.jsxs("p",{children:["Sorry,the ",e.jsx("strong",{children:"ORDER"})," and ",e.jsx("strong",{children:"WISHLIST"})," is restricted to registered users only."]}),e.jsxs("p",{children:["please",e.jsx(B,{to:"/auth/register",children:" register"})," or ",e.jsx(B,{to:"/auth/login",children:"login"})," to continue."]})]}),e.jsxs("div",{id:"Bag-Total-Price",children:[e.jsx("h4",{children:"Grand Total : "}),e.jsxs("h4",{children:["₹ ",m]}),e.jsx("button",{style:(i==null?void 0:i.Bag.length)>0?{}:{background:"grey"},onClick:b,children:L?e.jsx(D,{height:"14",width:"14",color:"white",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:6,strokeWidthSecondary:6}):e.jsx(e.Fragment,{children:"ORDER NOW"})})]})]})}):e.jsxs("div",{id:"bagBTN",children:[e.jsx(_,{onClick:()=>a(!r)}),(i==null?void 0:i.Bag.length)>0&&e.jsx("p",{children:i==null?void 0:i.Bag.length})]})})};export{V as B};
