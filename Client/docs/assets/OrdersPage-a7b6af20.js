import{r as t,N as y,j as e,b as S,U as P,u as L,c as R,a as k}from"./index-5c2fc0ab.js";import{H as N}from"./Header-f26ec214.js";import{F as T}from"./Footer-506c09df.js";import{S as F}from"./SearchBar-b2066a3c.js";import{O as I}from"./Blocks-c51b83d5.js";import{a as W}from"./index.esm-96b25de3.js";import{B}from"./Bags-738ba40e.js";import"./index.esm-192a7aeb.js";import"./index.esm-e089c406.js";import"./index.esm-d3d9663e.js";import"./index.esm-9d541a8c.js";import"./index.esm-7d62f1ed.js";const M=({product:r,orderData:s,ids:h,userData:f,setUserData:O})=>{const[j,v]=t.useState(null),[o,m]=t.useState(20),[a,x]=t.useState(!1);t.useState([]);const{checkUserAlreadyLogin:n,notification:g}=t.useContext(y),c=async d=>{x(!0),await S.post("/api/cancelOrder",{productID:d}).then(i=>{i.data==="Product Ordered Cancelled"&&n()}).catch(i=>{console.log(i)}).finally(()=>{x(!1)})},u={line:{background:`linear-gradient(to right, red ${o}%, black ${100-o}%)`,background:`-webkit-linear-gradient(360deg, red ${o}%, black ${100-o}%)`}};return t.useEffect(()=>{s.status==="CONFIRMED"&&m(20),s.status==="SHIPPED"&&m(40),s.status==="DELIVERY"&&m(60),s.status==="DELIVERED"&&m(100)},[s]),e.jsxs("div",{id:"order-details",children:[e.jsxs("div",{id:"order-details-inner",children:[e.jsxs("div",{children:[e.jsxs("span",{id:"order-id",children:["Order ID: ",s._id.slice(0,7)]}),e.jsxs("span",{id:"order-status",children:[".",s.status]})]}),e.jsx("span",{id:"order-date",children:new Date(s.orderedAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]}),e.jsx("div",{id:"orders-Collection",children:s.Orders.map(d=>{const i=r.find(C=>C._id===d.productID),p=i.Price*d.LargeCount+i.Price*d.MediumCount+i.Price*d.SmallCount;return e.jsxs("div",{id:"orderCards",children:[e.jsx("img",{src:i.Product_Photo}),e.jsxs("div",{children:[e.jsxs("div",{id:"product-name-pay",children:[e.jsx("h3",{children:i.Product_Name}),e.jsxs("p",{children:["You Pay: ₹",p," "]})]}),e.jsxs("p",{children:[i.Description.slice(0,200),"..."]})]})]})})}),e.jsxs("div",{id:"order-summary",children:[e.jsx("h4",{children:"Order Summary"}),e.jsxs("table",{children:[s.Orders.map(d=>{const i=r.find(C=>C._id===d.productID),p=i.Price*d.LargeCount+i.Price*d.MediumCount+i.Price*d.SmallCount;return e.jsxs("tr",{children:[e.jsxs("td",{children:[i.Product_Name,":"]}),e.jsxs("td",{children:["₹",p*(100-18)/100]})]})}),e.jsxs("tr",{children:[e.jsx("td",{children:"Delivery Charges: "}),e.jsx("td",{children:s.Delivery_Charge})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"GST: "}),e.jsx("td",{children:s.GST})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Discount: "}),e.jsx("td",{children:s.Discount})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Order Total:"}),e.jsx("td",{children:s.TotalAmountPayed})]})]})]}),e.jsxs("div",{id:"btns",children:[e.jsx("button",{onClick:()=>c(s.productID),children:a?e.jsx(I,{height:"14",width:"14",color:"white",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:6,strokeWidthSecondary:6}):e.jsx(e.Fragment,{children:"CANCEL"})}),e.jsx("button",{onClick:()=>{s.productID===j?v(null):v(s.productID)},children:"TRACK YOUR ORDER"})]}),j===s.productID&&e.jsx("div",{className:"track-order",children:e.jsxs("div",{children:[e.jsx("div",{id:"Line",style:u.line}),e.jsxs("div",{id:"track-collection",children:[e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=20?"trackDone":"",children:"1"}),e.jsx("h5",{children:"ORDER CONFIRMED "})]}),e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=40?"trackDone":"",children:"2"}),e.jsx("h5",{children:"ORDER SHIPPED"})]}),e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=60?"trackDone":"",children:"3"}),e.jsx("h5",{children:"OUT FOR DELIVERY"})]}),e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=100?"trackDone":"",children:"4"}),e.jsx("h5",{children:"DELIVERED"})]})]})]})})]})},A=({product:r,orderData:s,userData:h,setUserData:f})=>{const[O,j]=t.useState(!1);t.useContext(y);const{fetchWishList:v,wishlistData:o,fetchBag:m}=t.useContext(P),a=async n=>{let g=o.find(c=>c.productID===n);console.log("Clicked",g),g&&await S.post("/api/removefromWishlist",{productID:n}).then(c=>{v()})},x=async n=>{j(!0),h.Bag.find(c=>c.productID===n)||await S.post("/api/addtoBag",{productID:n,SmallCount:0,MediumCount:1,LargeCount:0}).then(c=>{j(!1),a(n),m()}),setTimeout(()=>j(!1),1e3)};return e.jsxs("div",{id:"WishList-Card",children:[e.jsx("img",{src:r==null?void 0:r.Product_Photo,alt:"ImageProduct"}),e.jsxs("div",{id:"productDesc",children:[e.jsx("h2",{children:r==null?void 0:r.Product_Name}),e.jsxs("p",{children:[r==null?void 0:r.Description.slice(0,180),"..."]})]}),e.jsxs("h1",{children:["₹",r==null?void 0:r.Price]}),e.jsx(W,{id:"IconClose",onClick:()=>a(s.productID)}),e.jsx("button",{onClick:()=>x(s.productID),children:O?e.jsx(I,{height:"14",width:"14",color:"white",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:6,strokeWidthSecondary:6}):e.jsx(e.Fragment,{children:h!=null&&h.Bag.find(n=>n.productID===s.productID)?e.jsx(e.Fragment,{children:" Added "}):e.jsx(e.Fragment,{children:"Add to Bag "})})})]})},H="/assets/scooter-cca3a519.png",U=()=>{const[r,s]=t.useState(!0),{userData:h,setUserData:f,fetchBag:O,fetchWishList:j,addToBag:v,addToWishlist:o,bagData:m,wishlistData:a}=t.useContext(P),[x,n]=t.useState(null),[g,c]=t.useState("Show"),[u,d]=t.useState([]),i=L(),p=R(),C=async()=>{c("Show"),await S.post("/api/fetchProduct",{Available:!1}).then(l=>{n(l.data.data),c("Hide"),j(),D()}).catch(l=>{console.log("Error"),c("LoadBtnShow")})};t.useEffect(()=>{C()},[]),t.useEffect(()=>{p.orders==="my-wishlist"?s(!1):s(!0)},[p]);const D=async()=>{await S.get("/api/fetchOrders").then(l=>{d(l.data.data)})};return e.jsxs(e.Fragment,{children:[e.jsx(F,{bgColor:"white"}),e.jsxs("div",{id:"Orders",children:[e.jsxs("div",{id:"order-wishlists",children:[e.jsx("h3",{onClick:()=>{i("/orders/my-order")},id:r?"active":"",children:"MY ORDERS"}),e.jsx("h3",{onClick:()=>{i("/orders/my-wishlist")},id:r?"":"active",children:"MY WISHLIST"})]}),g==="Hide"?e.jsx(e.Fragment,{children:h?e.jsx(e.Fragment,{children:r?e.jsx(e.Fragment,{children:(u==null?void 0:u.length)>0?e.jsx("div",{id:"orderCardsContainer",children:u==null?void 0:u.toReversed().map((l,w)=>e.jsx(M,{product:x,orderData:l,ids:w,userData:h,setUserData:f},l+w))}):e.jsx("div",{id:"orderCardsContainer",children:"No order is Placed till now"})}):e.jsx(e.Fragment,{children:(a==null?void 0:a.length)>0?e.jsx("div",{id:"wishlist",children:e.jsx("div",{id:"orderCardsContainer",children:a==null?void 0:a.toReversed().map((l,w)=>{const E=x==null?void 0:x.find(b=>b._id===l.productID);return e.jsx(A,{product:E,orderData:l,userData:h,setUserData:f},l+w)})})}):e.jsx("div",{id:"orderCardsContainer",children:"No Item Found"})})}):e.jsxs("div",{id:"orderCardsContainer",className:"userNotLogin",children:[e.jsxs("p",{children:["Sorry,the ",e.jsx("strong",{children:"ORDER"})," and ",e.jsx("strong",{children:"WISHLIST"})," is restricted to registered users only."]}),e.jsxs("p",{children:["please",e.jsx(k,{to:"/auth/register",children:" register"})," or ",e.jsx(k,{to:"/auth/login",children:"login"})," to continue."]})]})}):e.jsx(e.Fragment,{children:g==="Show"?e.jsx("div",{id:"orderCardsContainer",children:e.jsx(I,{height:"40",width:"60",color:"black",wrapperStyle:{marginTop:"100px"},wrapperClass:"orderProduct loading",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:4,strokeWidthSecondary:4})}):e.jsx("div",{id:"orderCardsContainer",children:e.jsxs("div",{className:"loadingBTN",children:[e.jsx("p",{children:"Something went wrong"}),e.jsx("button",{onClick:C,children:"Try again"})]})})})]}),e.jsx("img",{src:H,alt:"Scooter",id:"scooterIMG"}),e.jsx(B,{})]})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx(U,{}),e.jsx(T,{})]});export{ee as default};
