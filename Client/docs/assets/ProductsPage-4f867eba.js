import{r,d as T,N as k,U as F,e as D,j as t,a as W,b as h}from"./index-cbe3fdec.js";import{B as A}from"./Bags-d36cee3e.js";import{F as H}from"./Footer-c4c6fd8e.js";import{H as R}from"./Header-6d6a280a.js";import{b as _,c as E,d as U,e as V}from"./index.esm-24426d4d.js";import{a as O}from"./index.esm-513a21a3.js";import{V as $,L as M}from"./veg-6fb613a8.js";import{O as G}from"./Blocks-a4e89473.js";import{S as q}from"./SearchBar-0fe9641b.js";import"./index.esm-76ea1b92.js";import"./index.esm-a1d35d51.js";import"./index.esm-3905661c.js";import"./index.esm-7b03ea70.js";const z=()=>{const[f,m]=r.useState([]),[l,g]=r.useState(1),[u,J]=r.useState(24),[c,K]=r.useState(T()),[v,x]=r.useState(0),{notification:N,checkUserAlreadyLogin:p}=r.useContext(k),{userData:o,setUserData:Q}=r.useContext(F),[n,y]=r.useState([]),[w,j]=r.useState("Show");let b=l*u,S=b-u;const P=D(),C=async()=>{j("Show"),await h.post("/api/fetchProduct",{Available:!0}).then(e=>{y(e.data.data),j("Hide")}).catch(e=>{j("LoadBtnShow"),console.log("Error")}).finally(()=>{})};r.useEffect(()=>{C()},[]),r.useEffect(()=>{let e=[];if(P.state!==null){let s=P.state;if(e.length<=0&&(n==null||n.filter(i=>{s.Category.filter(a=>{a.apiName===i.Category&&e.push(i)})})),e.length<=0&&n.filter(i=>{s.Ingredients.filter(a=>{a.apiName===i.type&&e.push(i)})}),e.length>0&&s.Ingredients.length>0){let i=[];e.filter((a,X)=>{s.Ingredients.filter(L=>{L.apiName===a.type&&i.push(a)})}),e=i}if(e.length<=0&&n.filter(i=>{i.Price<=parseInt(s.PriceRange)&&e.push(i)}),e.length>0){let i=[];e.filter(a=>{a.Price<=parseInt(s.PriceRange)&&i.push(a)}),e=i}if(e.length<=0&&n.filter(i=>{i.Star>=s.RatingUP&&e.push(i)}),e.length>0){let i=[];e.filter(a=>{a.Star>=s.RatingUP&&i.push(a)}),e=i}m(e),g(1)}else m(f)},[P,n]),r.useEffect(()=>{let e;Object.keys(c).length>0?e=n.filter(s=>s.Category===c.categoryID||s._id===c.categoryID):e=n,m(e)},[c,n]);let d=[];for(let e=1;e<=Math.ceil(f.length/u);e++)d.push(e);const B=async e=>{o?o.Wishlist.find(i=>i.productID===e)?await h.post("/api/removefromWishlist",{productID:e}).then(i=>{p()}):await h.post("/api/addToWishlist",{productID:e}).then(i=>{p()}):N("Please Login Before Adding to Wishlist","Warning")},I=async e=>{o?o.Bag.find(i=>i.productID===e)?await h.post("/api/removeFromBag",{productID:e}).then(i=>{p()}):await h.post("/api/addtoBag",{productID:e,SmallCount:0,MediumCount:1,LargeCount:0}).then(i=>{p()}):N("Please Login Before Adding to Bag","Warning")};return t.jsx(t.Fragment,{children:w==="Hide"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"products",children:f.slice(S,b).map(e=>{let s;return c.categoryID?s=`./${e._id}`:s=`./${e.Category}/${e._id}`,t.jsxs("div",{className:"product-card",children:[e.type==="Veg"?t.jsx("img",{id:"veg",src:$,alt:"Veg"}):t.jsx(M,{id:"LuVegan"}),t.jsx("div",{id:"product-img-BTN1",children:t.jsxs("div",{id:"onhover-showBTN1",children:[t.jsx("p",{id:"wishlist-para",children:"WISHLIST"}),t.jsx(_,{onClick:()=>B(e._id),className:o!=null&&o.Wishlist.find(i=>i.productID===e._id)?"active-Heart heart":" heart"})]})}),t.jsx("div",{id:"product-img-BTN2",children:t.jsxs("div",{id:"onhover-showBTN2",children:[t.jsx("p",{id:"bag-para",children:"BAG"}),t.jsx(O,{onClick:()=>I(e._id),className:o!=null&&o.Bag.find(i=>i.productID===e._id)?"active-Bags bag":"bag"})]})}),t.jsxs(W,{to:s,onClick:()=>window.scrollTo({top:0,left:0,behavior:"smooth"}),children:[t.jsx("img",{src:e.Product_Photo,alt:e.Product_Name,className:"product-image skeleton"}),t.jsxs("div",{className:"product-info",children:[t.jsx("h5",{className:"product-name",children:e.Product_Name}),t.jsxs("p",{className:"product-desc",children:[e.Description.slice(0,60),"..."]}),t.jsxs("p",{className:"product-price",children:["â‚¹",e.Price]}),t.jsxs("div",{id:"rating",children:[t.jsx(E,{id:"A"}),t.jsxs("p",{className:"product-rating",children:[Number(e.Rating).toFixed(1),"/5.0"]})]})]})]})]},e._id)})}),t.jsx("div",{id:"pagination",children:d.length>1&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"Pages",id:l===1?"non-active-side-btn":"",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),l!==1&&(x(v-18),g(l-1))},children:t.jsx(U,{})}),d.map((e,s)=>t.jsx("div",{onClick:()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),x(e),g(s+1)},className:s+1===l?"activePage Pages":"Pages",children:s+1},s)),t.jsx("div",{className:"Pages",id:l===d.length?"non-active-side-btn":"",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),l!==d.length&&(x(v+18),g(l+1))},children:t.jsx(V,{})})]})})]}):t.jsx(t.Fragment,{children:w==="Show"?t.jsx(G,{height:"40",width:"60",color:"white",wrapperStyle:{},wrapperClass:"products loading",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:4,strokeWidthSecondary:4}):t.jsxs("div",{className:"products loadingBTN",children:[t.jsx("p",{children:"Something went wrong"}),t.jsx("button",{onClick:C,children:"Try again"})]})})})},he=()=>t.jsxs(t.Fragment,{children:[t.jsx(R,{}),t.jsx(A,{}),t.jsx(q,{position:"100",currPlace:"ProductPage"}),t.jsx(z,{}),t.jsx(H,{})]});export{he as default};
