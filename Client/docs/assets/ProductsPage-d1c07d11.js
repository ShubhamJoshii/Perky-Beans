import{r,d as k,N as D,U as F,e as T,j as t,a as W,b as g}from"./index-dbb2527e.js";import{B as A}from"./Bags-d9fdcdc4.js";import{F as R}from"./Footer-8e48a51a.js";import{H as _}from"./Header-15d56c07.js";import{c as E,d as U,e as V,f as H}from"./index.esm-7735cdba.js";import{a as O}from"./index.esm-a8bd4a32.js";import{V as $,L as M}from"./veg-fd9521f4.js";import{O as G}from"./Blocks-0e59252c.js";import{S as q}from"./SearchBar-55a3fc4a.js";import"./index.esm-0691a448.js";import"./index.esm-d3697b5c.js";import"./index.esm-c62830c2.js";import"./index.esm-b62fc84f.js";const z=()=>{const[p,m]=r.useState([]),[n,h]=r.useState(1),[u,J]=r.useState(24),[c,K]=r.useState(k()),[P,x]=r.useState(0),{notification:v,checkUserAlreadyLogin:f}=r.useContext(D),{userData:o,setUserData:Q}=r.useContext(F),[l,b]=r.useState([]),[C,w]=r.useState(!0);let N=n*u,y=N-u;const j=T(),I=async()=>{await g.post("/api/fetchProduct",{Available:!0}).then(e=>{b(e.data.data)}).catch(e=>{console.log("Error")}).finally(()=>{w(!1)})};r.useEffect(()=>{I()},[]),r.useEffect(()=>{let e=[];if(j.state!==null){let i=j.state;if(e.length<=0&&(l==null||l.filter(s=>{i.Category.filter(a=>{a.apiName===s.Category&&e.push(s)})})),e.length<=0&&l.filter(s=>{i.Ingredients.filter(a=>{a.apiName===s.type&&e.push(s)})}),e.length>0&&i.Ingredients.length>0){let s=[];e.filter((a,X)=>{i.Ingredients.filter(L=>{L.apiName===a.type&&s.push(a)})}),e=s}if(e.length<=0&&l.filter(s=>{s.Price<=parseInt(i.PriceRange)&&e.push(s)}),e.length>0){let s=[];e.filter(a=>{a.Price<=parseInt(i.PriceRange)&&s.push(a)}),e=s}if(e.length<=0&&l.filter(s=>{s.Star>=i.RatingUP&&e.push(s)}),e.length>0){let s=[];e.filter(a=>{a.Star>=i.RatingUP&&s.push(a)}),e=s}m(e),h(1)}else m(p)},[j,l]),r.useEffect(()=>{let e;Object.keys(c).length>0?e=l.filter(i=>i.Category===c.categoryID||i._id===c.categoryID):e=l,m(e)},[c,l]);let d=[];for(let e=1;e<=Math.ceil(p.length/u);e++)d.push(e);const B=async e=>{o?o.Wishlist.find(s=>s.productID===e)?await g.post("/api/removefromWishlist",{productID:e}).then(s=>{f()}):await g.post("/api/addToWishlist",{productID:e}).then(s=>{f()}):v("Please Login Before Adding to Wishlist","Warning")},S=async e=>{o?o.Bag.find(s=>s.productID===e)?await g.post("/api/removeFromBag",{productID:e}).then(s=>{f()}):await g.post("/api/addtoBag",{productID:e,SmallCount:0,MediumCount:1,LargeCount:0}).then(s=>{f()}):v("Please Login Before Adding to Bag","Warning")};return t.jsx(t.Fragment,{children:C?t.jsx(G,{height:"40",width:"60",color:"white",wrapperStyle:{},wrapperClass:"products loading",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:4,strokeWidthSecondary:4}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"products",children:p.slice(y,N).map(e=>{let i;return c.categoryID?i=`./${e._id}`:i=`./${e.Category}/${e._id}`,t.jsxs("div",{className:"product-card",children:[e.type==="Veg"?t.jsx("img",{id:"veg",src:$,alt:"Veg"}):t.jsx(M,{id:"LuVegan"}),t.jsx("div",{id:"product-img-BTN1",children:t.jsxs("div",{id:"onhover-showBTN1",children:[t.jsx("p",{id:"wishlist-para",children:"WISHLIST"}),t.jsx(E,{onClick:()=>B(e._id),className:o!=null&&o.Wishlist.find(s=>s.productID===e._id)?"active-Heart heart":" heart"})]})}),t.jsx("div",{id:"product-img-BTN2",children:t.jsxs("div",{id:"onhover-showBTN2",children:[t.jsx("p",{id:"bag-para",children:"BAG"}),t.jsx(O,{onClick:()=>S(e._id),className:o!=null&&o.Bag.find(s=>s.productID===e._id)?"active-Bags bag":"bag"})]})}),t.jsxs(W,{to:i,onClick:()=>window.scrollTo({top:0,left:0,behavior:"smooth"}),children:[t.jsx("img",{src:e.Product_Photo,alt:e.Product_Name,className:"product-image skeleton"}),t.jsxs("div",{className:"product-info",children:[t.jsx("h5",{className:"product-name",children:e.Product_Name}),t.jsxs("p",{className:"product-desc",children:[e.Description.slice(0,60),"..."]}),t.jsxs("p",{className:"product-price",children:["â‚¹",e.Price]}),t.jsxs("div",{id:"rating",children:[t.jsx(U,{id:"A"}),t.jsxs("p",{className:"product-rating",children:[Number(e.Rating).toFixed(1),"/5.0"]})]})]})]})]},e._id)})}),t.jsx("div",{id:"pagination",children:d.length>1&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"Pages",id:n===1?"non-active-side-btn":"",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),n!==1&&(x(P-18),h(n-1))},children:t.jsx(V,{})}),d.map((e,i)=>t.jsx("div",{onClick:()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),x(e),h(i+1)},className:i+1===n?"activePage Pages":"Pages",children:i+1},i)),t.jsx("div",{className:"Pages",id:n===d.length?"non-active-side-btn":"",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"smooth"}),n!==d.length&&(x(P+18),h(n+1))},children:t.jsx(H,{})})]})})]})})},ge=()=>t.jsxs(t.Fragment,{children:[t.jsx(_,{}),t.jsx(A,{}),t.jsx(q,{position:"100",currPlace:"ProductPage"}),t.jsx(z,{}),t.jsx(R,{})]});export{ge as default};
