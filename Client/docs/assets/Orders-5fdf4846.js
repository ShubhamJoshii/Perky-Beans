import{r as i,N as D,j as t,b as d}from"./index-98f0d127.js";import"./react-table.production.min-b897927e.js";import{A as E}from"./AdminSidebar-01459f2e.js";import{O as m}from"./Blocks-3465ce0c.js";import"./index.esm-79fba085.js";import"./index.esm-d04a934b.js";import"./index.esm-3249597b.js";const _=()=>{const[l,f]=i.useState([]),[x,g]=i.useState(),[r,p]=i.useState(),[b,c]=i.useState(!1),{notification:j}=i.useContext(D),u=async()=>{await d.get("/api/fetchAllOrders").then(e=>{console.log(e.data.data),f(e.data.data),S(),y()}).catch(e=>{console.log(e)})},S=async()=>{await d.post("/api/fetchProduct",{Available:!1}).then(e=>{g(e.data.data)}).catch(e=>{console.log("Error")}).finally(()=>{c(!1)})},y=async()=>{c(!0),await d.get("/api/fetchUsers").then(e=>{var n;(n=e.data)!=null&&n.data&&p(e.data.data)}).catch(e=>{console.log("Error")}).finally(()=>{c(!1)})};i.useEffect(()=>{u()},[]);const h=async(e,n)=>{await d.post("/api/changeStatus",{_id:n,status:e}).then(a=>{a.data.result?(j(a.data.message,"Success"),u()):j(a.data.message,"Un-Success")}).catch(a=>{console.log(a)})};return t.jsxs("div",{className:"admin-container",children:[t.jsx(E,{}),t.jsxs("div",{className:"dashboard-product-box",children:[t.jsx("h2",{className:"heading",children:"Orders"}),t.jsxs("table",{className:"table",role:"table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"User Name"}),t.jsx("th",{children:"Order At"}),t.jsx("th",{children:"Order"}),t.jsx("th",{children:"Amount"}),t.jsx("th",{children:"Discount"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Manage"})]})}),b?t.jsx("td",{colSpan:"10",children:t.jsx(m,{height:"40",width:"60",color:"black",wrapperStyle:{},wrapperClass:"loading",visible:!0,ariaLabel:"oval-loading",secondaryColor:"black",strokeWidth:4,strokeWidthSecondary:4})}):t.jsx("tbody",{children:l&&r&&x?t.jsx(t.Fragment,{children:l==null?void 0:l.slice().reverse().map(e=>{const n=r==null?void 0:r.find(s=>s._id===e.user_id),a=["CONFIRMED","SHIPPED","DELIVERY","DELIVERED"],o=a==null?void 0:a.findIndex(s=>s===e.status);return t.jsxs("tr",{id:"orders-table",children:[t.jsx("th",{children:n.Full_Name}),t.jsx("th",{children:new Date(e.orderedAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}),t.jsx("th",{children:t.jsx("ul",{children:e.Orders.map(s=>{const C=x.find(k=>k._id===s.productID);return t.jsxs("li",{children:[C.Product_Name," - ",s.SmallCount>0&&`${s.SmallCount}S`,s.MediumCount>0&&`${s.MediumCount}M`," ",s.LargeCount>0&&`${s.LargeCount}L`]})})})}),t.jsxs("th",{children:["₹ ",e.TotalAmountPayed]}),t.jsxs("th",{children:[" ₹ ",e.Discount]}),t.jsxs("th",{children:[" ",e.status]}),o===0&&t.jsx("th",{children:t.jsx("button",{onClick:()=>h(a[1],e._id),children:a[1]})}),o===1&&t.jsx("th",{children:t.jsx("button",{onClick:()=>h(a[2],e._id),children:a[2]})}),o===2&&t.jsx("th",{children:t.jsx("button",{onClick:()=>h(a[3],e._id),children:a[3]})}),o===3&&t.jsx("th",{children:"Order Delivery"})]})})}):t.jsx("td",{colSpan:"10",children:t.jsx(m,{height:"40",width:"60",color:"black",wrapperStyle:{},wrapperClass:"loading",visible:!0,ariaLabel:"oval-loading",secondaryColor:"black",strokeWidth:4,strokeWidthSecondary:4})})})]})]})]})};export{_ as default};
