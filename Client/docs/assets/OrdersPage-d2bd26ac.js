import{r as t,N as y,j as e,b as S,U as P,u as R,c as N,a as k}from"./index-98f0d127.js";import{H as T}from"./Header-6ac32451.js";import{F}from"./Footer-a1b8e172.js";import{S as D}from"./SearchBar-9f61d920.js";import{O as I}from"./Blocks-3465ce0c.js";import{a as W}from"./index.esm-d04a934b.js";import{B}from"./Bags-b9116bc3.js";import"./index.esm-a66f5f8d.js";import"./index.esm-7c76c066.js";import"./index.esm-3249597b.js";import"./index.esm-79fba085.js";import"./index.esm-e83a1523.js";const M=({product:i,orderData:s,ids:h,userData:f,setUserData:O})=>{const[j,v]=t.useState(null),[o,m]=t.useState(20),[c,x]=t.useState(!1);t.useState([]);const{checkUserAlreadyLogin:n,notification:g}=t.useContext(y),l=async d=>{x(!0),await S.post("/api/cancelOrder",{productID:d}).then(r=>{r.data==="Product Ordered Cancelled"&&n()}).catch(r=>{console.log(r)}).finally(()=>{x(!1)})},u={line:{background:`linear-gradient(to right, red ${o}%, black ${100-o}%)`,background:`-webkit-linear-gradient(360deg, red ${o}%, black ${100-o}%)`}};return t.useEffect(()=>{s.status==="CONFIRMED"&&m(20),s.status==="SHIPPED"&&m(40),s.status==="DELIVERY"&&m(60),s.status==="DELIVERED"&&m(100)},[s]),e.jsxs("div",{id:"order-details",children:[e.jsxs("div",{id:"order-details-inner",children:[e.jsxs("div",{children:[e.jsxs("span",{id:"order-id",children:["Order ID: ",s._id.slice(0,7)]}),e.jsxs("span",{id:"order-status",children:[".",s.status]})]}),e.jsx("span",{id:"order-date",children:new Date(s.orderedAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})})]}),e.jsx("div",{id:"orders-Collection",children:s.Orders.map(d=>{const r=i.find(C=>C._id===d.productID),p=r.Price*d.LargeCount+r.Price*d.MediumCount+r.Price*d.SmallCount;return e.jsxs("div",{id:"orderCards",children:[e.jsx("img",{src:r.Product_Photo}),e.jsxs("div",{children:[e.jsxs("div",{id:"product-name-pay",children:[e.jsx("h3",{children:r.Product_Name}),e.jsxs("p",{children:["You Pay: ₹",p," "]})]}),e.jsxs("p",{children:[r.Description.slice(0,200),"..."]})]})]})})}),e.jsxs("div",{id:"order-summary",children:[e.jsx("h4",{children:"Order Summary"}),e.jsxs("table",{children:[s.Orders.map(d=>{const r=i.find(C=>C._id===d.productID),p=r.Price*d.LargeCount+r.Price*d.MediumCount+r.Price*d.SmallCount;return e.jsxs("tr",{children:[e.jsxs("td",{children:[r.Product_Name,":"]}),e.jsxs("td",{children:["₹ ",p*(100-18)/100]})]})}),e.jsxs("tr",{children:[e.jsx("td",{children:"Delivery Charges: "}),e.jsxs("td",{children:["₹ ",s.Delivery_Charge]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"GST: "}),e.jsxs("td",{children:["₹ ",s.GST]})]}),s.Discount>0&&e.jsxs("tr",{children:[e.jsxs("td",{children:["Discount: ",(s==null?void 0:s.Coupon_Used)&&e.jsxs("span",{children:["(",s==null?void 0:s.Coupon_Used,")"]})," "]}),e.jsxs("td",{children:["₹ ",s.Discount]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Order Total:"}),e.jsxs("td",{children:["₹ ",s.TotalAmountPayed]})]})]})]}),e.jsxs("div",{id:"btns",children:[e.jsx("button",{onClick:()=>l(s.productID),children:c?e.jsx(I,{height:"14",width:"14",color:"white",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:6,strokeWidthSecondary:6}):e.jsx(e.Fragment,{children:"CANCEL"})}),e.jsx("button",{onClick:()=>{s.productID===j?v(null):v(s.productID)},children:"TRACK YOUR ORDER"})]}),j===s.productID&&e.jsx("div",{className:"track-order",children:e.jsxs("div",{children:[e.jsx("div",{id:"Line",style:u.line}),e.jsxs("div",{id:"track-collection",children:[e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=20?"trackDone":"",children:"1"}),e.jsx("h5",{children:"ORDER CONFIRMED "})]}),e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=40?"trackDone":"",children:"2"}),e.jsx("h5",{children:"ORDER SHIPPED"})]}),e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=60?"trackDone":"",children:"3"}),e.jsx("h5",{children:"OUT FOR DELIVERY"})]}),e.jsxs("div",{id:"timeStamp-Order",children:[e.jsx("div",{id:"currStage-Order",className:o>=100?"trackDone":"",children:"4"}),e.jsx("h5",{children:"DELIVERED"})]})]})]})})]})},U=({product:i,orderData:s,userData:h,setUserData:f})=>{const[O,j]=t.useState(!1);t.useContext(y);const{fetchWishList:v,wishlistData:o,fetchBag:m}=t.useContext(P),c=async n=>{let g=o.find(l=>l.productID===n);console.log("Clicked",g),g&&await S.post("/api/removefromWishlist",{productID:n}).then(l=>{v()})},x=async n=>{j(!0),h.Bag.find(l=>l.productID===n)||await S.post("/api/addtoBag",{productID:n,SmallCount:0,MediumCount:1,LargeCount:0}).then(l=>{j(!1),c(n),m()}),setTimeout(()=>j(!1),1e3)};return e.jsxs("div",{id:"WishList-Card",children:[e.jsx("img",{src:i==null?void 0:i.Product_Photo,alt:"ImageProduct"}),e.jsxs("div",{id:"productDesc",children:[e.jsx("h2",{children:i==null?void 0:i.Product_Name}),e.jsxs("p",{children:[i==null?void 0:i.Description.slice(0,180),"..."]})]}),e.jsxs("h1",{children:["₹",i==null?void 0:i.Price]}),e.jsx(W,{id:"IconClose",onClick:()=>c(s.productID)}),e.jsx("button",{onClick:()=>x(s.productID),children:O?e.jsx(I,{height:"14",width:"14",color:"white",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:6,strokeWidthSecondary:6}):e.jsx(e.Fragment,{children:h!=null&&h.Bag.find(n=>n.productID===s.productID)?e.jsx(e.Fragment,{children:" Added "}):e.jsx(e.Fragment,{children:"Add to Bag "})})})]})},A="/assets/scooter-cca3a519.png",_=()=>{const[i,s]=t.useState(!0),{userData:h,setUserData:f,fetchBag:O,fetchWishList:j,addToBag:v,addToWishlist:o,bagData:m,wishlistData:c}=t.useContext(P),[x,n]=t.useState(null),[g,l]=t.useState("Show"),[u,d]=t.useState([]),r=R(),p=N(),C=async()=>{l("Show"),await S.post("/api/fetchProduct",{Available:!1}).then(a=>{n(a.data.data),l("Hide"),j(),E()}).catch(a=>{console.log("Error"),l("LoadBtnShow")})};t.useEffect(()=>{C()},[]),t.useEffect(()=>{p.orders==="my-wishlist"?s(!1):s(!0)},[p]);const E=async()=>{await S.get("/api/fetchOrders").then(a=>{d(a.data.data)})};return e.jsxs(e.Fragment,{children:[e.jsx(D,{bgColor:"white"}),e.jsxs("div",{id:"Orders",children:[e.jsxs("div",{id:"order-wishlists",children:[e.jsx("h3",{onClick:()=>{r("/orders/my-order")},id:i?"active":"",children:"MY ORDERS"}),e.jsx("h3",{onClick:()=>{r("/orders/my-wishlist")},id:i?"":"active",children:"MY WISHLIST"})]}),g==="Hide"?e.jsx(e.Fragment,{children:h?e.jsx(e.Fragment,{children:i?e.jsx(e.Fragment,{children:(u==null?void 0:u.length)>0?e.jsx("div",{id:"orderCardsContainer",children:u==null?void 0:u.toReversed().map((a,w)=>e.jsx(M,{product:x,orderData:a,ids:w,userData:h,setUserData:f},a+w))}):e.jsx("div",{id:"orderCardsContainer",children:"No order is Placed till now"})}):e.jsx(e.Fragment,{children:(c==null?void 0:c.length)>0?e.jsx("div",{id:"wishlist",children:e.jsx("div",{id:"orderCardsContainer",children:c==null?void 0:c.toReversed().map((a,w)=>{const b=x==null?void 0:x.find(L=>L._id===a.productID);return e.jsx(U,{product:b,orderData:a,userData:h,setUserData:f},a+w)})})}):e.jsx("div",{id:"orderCardsContainer",children:"No Item Found"})})}):e.jsxs("div",{id:"orderCardsContainer",className:"userNotLogin",children:[e.jsxs("p",{children:["Sorry,the ",e.jsx("strong",{children:"ORDER"})," and ",e.jsx("strong",{children:"WISHLIST"})," is restricted to registered users only."]}),e.jsxs("p",{children:["please",e.jsx(k,{to:"/auth/register",children:" register"})," or ",e.jsx(k,{to:"/auth/login",children:"login"})," to continue."]})]})}):e.jsx(e.Fragment,{children:g==="Show"?e.jsx("div",{id:"orderCardsContainer",children:e.jsx(I,{height:"40",width:"60",color:"black",wrapperStyle:{marginTop:"100px"},wrapperClass:"orderProduct loading",visible:!0,ariaLabel:"oval-loading",secondaryColor:"white",strokeWidth:4,strokeWidthSecondary:4})}):e.jsx("div",{id:"orderCardsContainer",children:e.jsxs("div",{className:"loadingBTN",children:[e.jsx("p",{children:"Something went wrong"}),e.jsx("button",{onClick:C,children:"Try again"})]})})})]}),e.jsx("img",{src:A,alt:"Scooter",id:"scooterIMG"}),e.jsx(B,{})]})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(_,{}),e.jsx(F,{})]});export{ee as default};
